<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plinko</title>
    <script src = "js/pixi.min.js"></script>

   <script>

    let app;
    let box;

    let start_p;
    let pins;
    let player_node;
    let score_text_node; let score_text = "n/a";
    let player_score = 100; //default score
    
    function create_player(pivot, w, h, app_w, app_h) //FUNCTION TO CREATE NEW PLAYER
    {
        player_node = PIXI.Sprite.from("/images/player_ball.png");
        player_node.anchor.set(pivot)
        player_node.width = w;
        player_node.height = h;

        player_node.position.set(app_w, app_h);

        player_node.vy = 0;
        app.stage.addChild(player_node)
    }

    function create_text_node(t)
    {
        const text_style = new PIXI.TextStyle({
            fontSize: 40
        });

        score_text_node = new PIXI.Text(t.toString(), text_style);
        app.stage.addChild(score_text_node);
    }

    function create_bucket(w, h, app_w, app_h, world)
    {
        box = PIXI.Sprite.from("images/collect_box.png");

        box.width = w;
        box.height = h;
        box.x = app_w;
        box.y = app_h;
        
        world.stage.addChild(box);

    }

    function create_start_point(w, h, app_w, app_h, world)
    {
        start_p = PIXI.Sprite.from("images/player_start_point.png");

        start_p.width = w;
        start_p.height = h;
        start_p.x = app_w;
        start_p.y = app_h;
        
        world.stage.addChild(start_p);
    }

    function create_pins(w, h, app_w, app_h, world)
    {

        // WE WILL USE THE STAR PATTERN ALGORITHM TO SET THE PINS IN GRID SHAPE
        pins = PIXI.Sprite.from("images/pins.png");

        pins.width = w;
        pins.height = h;
        pins.x = app_w;
        pins.y = app_h;
        
        world.stage.addChild(pins);
    }

    function set_bucket_text(stemp)
    {//function to change bucket score text
        const b_style = new PIXI.TextStyle({
            fontSize: 20
        });

        const bucket_text = new PIXI.Text(stemp.toString(), b_style);
        bucket_text.anchor.set(0);
        bucket_text.x = stemp;
        bucket_text.y = 500;

        app.stage.addChild(bucket_text);
    }

    function create_game_world()
    {
        let b_temp = 60; //buckets far left position

        for (let i = 0; i < 9; i++)
        {
            create_bucket(80, 40, (b_temp), 500, app);
            set_bucket_text(b_temp);

            b_temp += 100;
        }
        
        
        create_start_point(45, 45, app.view.width/2, 0, app); //STARTING POINT

        
        create_pins(20, 20, 400, 100, app); //PINS
        create_pins(20, 20, 500, 100, app);
        create_pins(20, 20, 600, 100, app);
        create_pins(20, 20, 400, 200, app);
        create_pins(20, 20, 500, 200, app);
        create_pins(20, 20, 600, 200, app);
        create_pins(20, 20, 300, 200, app);
        create_pins(20, 20, 700, 200, app);
    }

    window.onload = function()
    {
        app = new PIXI.Application(
            {
                width: 1000,
                height: 600,
                backgroundColor: 818041}
        );
        document.body.appendChild(app.view);
            
        //create game world and add nodes:
        create_game_world();
        create_player(0.5, 40, 40, app.view.width/2, 25);
        create_text_node(score_text);

        app.ticker.add((delta) =>
        {
            score_text_node.text = player_score.toString();

            if (player_score > 0)
            {
                //player_score -= 0.01;
            }
            
        });
    }
   </script>

</head>
<body>
</body>
</html>