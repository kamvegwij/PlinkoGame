<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plinko</title>
    <script src = "js/pixi.min.js"></script>

   <script>
    

    class WorldItems
    {
        constructor(w, h, app_w, app_h, app_obj)
        {
            this.w = w;
            this.h = h;
            this.app_h = app_w;
            this.app_w = app_h;
            this.app = app_obj;
        }
        
    }

    let app;
    let box;
    let player;
    let start_p;
    let pins;

    function set_player(pl, pivot, w, h, app_w, app_h) //FUNCTION TO CREATE NEW PLAYER
    {
        pl.anchor.set(pivot)
        pl.width = w;
        pl.height = h;

        //move player to center of screen
        pl.x = app_w;
        pl.y = app_h;

        pl.vy = 0;
    }

    function set_bucket(w, h, app_w, app_h, world)
    {
        box = PIXI.Sprite.from("images/collect_box.png");

        box.width = w;
        box.height = h;
        box.x = app_w;
        box.y = app_h;
        
        world.stage.addChild(box);

    }

    function set_start_point(w, h, app_w, app_h, world)
    {
        start_p = PIXI.Sprite.from("images/player_start_point.png");

        start_p.width = w;
        start_p.height = h;
        start_p.x = app_w;
        start_p.y = app_h;
        
        world.stage.addChild(start_p);
    }

    function set_pins(w, h, app_w, app_h, world)
    {

        // WE WILL USE THE STAR PATTERN ALGORITHM TO SET THE PINS IN GRID SHAPE
        pins = PIXI.Sprite.from("images/pins.png");

        pins.width = w;
        pins.height = h;
        pins.x = app_w;
        pins.y = app_h;
        
        world.stage.addChild(pins);
    }

    function change_bucket_text(stemp)
    {//function to change bucket score text
        const b_style = new PIXI.TextStyle({
            fontSize: 20
        });

        const bucket_text = new PIXI.Text(stemp.toString(), b_style);
        bucket_text.anchor.set(0);
        bucket_text.x = stemp;
        bucket_text.y = 500;

        app.stage.addChild(bucket_text);
    }

    function make_game_world()
    {
        let b_temp = 60; //buckets far left position

       

        for (let i = 0; i < 9; i++)
        {
            set_bucket(80, 40, (b_temp), 500, app);
            change_bucket_text(b_temp);

            b_temp += 100;
        }
        
        
        set_start_point(45, 45, app.view.width/2, 0, app); //STARTING POINT

        
        set_pins(20, 20, 400, 100, app); //PINS
        set_pins(20, 20, 500, 100, app);
        set_pins(20, 20, 600, 100, app);
        set_pins(20, 20, 400, 200, app);
        set_pins(20, 20, 500, 200, app);
        set_pins(20, 20, 600, 200, app);
        set_pins(20, 20, 300, 200, app);
        set_pins(20, 20, 700, 200, app);
    }

    window.onload = function()
    {
        app = new PIXI.Application(
            {
                width: 1000,
                height: 600,
                backgroundColor: 818041}
        );
        document.body.appendChild(app.view);
        make_game_world();

        
        player = PIXI.Sprite.from("/images/player_ball.png");
        set_player(player, 0.5, 40, 40, app.view.width/2, 25);
        app.stage.addChild(player); //ADD PLAYER TO THE GAME

        app.ticker.add((delta) =>
        {
            player.y += player.vy;
            player.vy += 0.001;

            if (player.y > 200)
            {
                player.vy *= -0.005;
                player.y += player.vy;
            }
        });
    }
   </script>

</head>
<body>
</body>
</html>